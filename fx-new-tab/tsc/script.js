const currency_api="https://cdn.jsdelivr.net/gh/fawazahmed0/currency-api@1/latest/currencies/",img_api="https://icon.horse/icon/",node={currency:{name:"currency_name_",value:"currency_value_",option:"currency_option_"},shortcut:{link:"link_",name:"name_",img:"img_"},shortcut_setting:{link:"select_link_",name:"select_name_",img:"select_img_"},note:{note:"note_",input:"note_input_"}};function ready(){translate(),configure_shortcuts(),configure_notes(),is_currency_rates_enabled()&&(update_currency_html_elements(),did_a_day_pass()&&get_updated_rates()),config_settings_page()}function get_shortcuts(){let e=localStorage.getItem("shortcuts");if(null!=e)return JSON.parse(e);let t=[{name:"",img:"",link:"https://github.com"},{name:"",img:"",link:"https://youtube.com/"},{name:"",img:"",link:"https://chat.openai.com"},{name:"",img:"",link:"https://mail.google.com/mail/u/0/#inbox"},{name:"",img:"",link:"https://discord.com"},{name:"",img:"",link:"https://web.telegram.org/a/"},{name:"",img:"",link:"https://web.whatsapp.com/"},{name:"",img:"",link:"https://amazon.com"}];return localStorage.setItem("shortcuts",JSON.stringify(t)),t}window.addEventListener("DOMContentLoaded",ready);var active_shortcut_number=0;function configure_shortcuts(){active_shortcut_number=0;let e=get_shortcuts();for(let t=0;t<8;t++)set_shortcut_node(e[t],t);align_shortcut_nodes()}function get_notes(){const e=localStorage.getItem("notes");if(null!=e&&""!=e)return JSON.parse(e);let t=[{note:""},{note:""},{note:""},{note:""}];return localStorage.setItem("notes",JSON.stringify(t)),t}function configure_notes(){var e=get_notes();for(let a=0;a<4;a++){var t=document.getElementById(node.note.note+a);t.innerHTML=e[a].note;var n=document.getElementById(node.note.input+a);t.addEventListener("click",(()=>{var e=document.getElementById(node.note.note+a),t=document.getElementById(node.note.input+a);t.value=e.innerHTML,e.hidden=!0,t.hidden=!1,t.focus()})),n.addEventListener("change",(()=>{save_note(a)})),n.addEventListener("blur",(()=>{save_note(a)}))}}function save_note(e){var t=document.getElementById(node.note.note+e),n=document.getElementById(node.note.input+e);n.value=n.value.trim();var a=get_notes();a[e].note=n.value,localStorage.setItem("notes",JSON.stringify(a)),t.innerHTML=n.value,n.hidden=!0,t.hidden=!1}function set_shortcut_node(e,t){var n=document.getElementById(node.shortcut.link+t),a=n.parentElement;if(null!=a)if(""!=e.link){""==e.name&&(e.name=e.link.replace("https://","").replace("http://","").split("/")[0]),active_shortcut_number+=1,a.hidden=!1,n.href=e.link;var r=document.getElementById(node.shortcut.name+t),i=document.getElementById(node.shortcut.img+t);r.innerHTML=e.name,i.src=e.img,(""==e.img||i.naturalHeight<64||i.naturalWidth<64)&&get_favicon_from_url(e.link,t)}else a.hidden=!0}function align_shortcut_nodes(){var e=document.getElementById("ShortcutContainer");active_shortcut_number<=4?e.classList.replace("align-items-start","align-items-center"):e.classList.replace("align-items-center","align-items-start")}function get_favicon_from_url(e,t){if(0==navigator.onLine)return void console.log("No internet connection. Cant get favicons.");e=e.replace("https://","").replace("http://","").replace("www.","").split("/")[0];let n=new Image;n.crossOrigin="anonymous",n.src=img_api+e,n.addEventListener("load",(function(){let e=document.createElement("canvas"),a=e.getContext("2d");e.width=n.width,e.height=n.height,a.drawImage(n,0,0);var r=e.toDataURL();document.getElementById(node.shortcut.img+t).src=r;let i=get_shortcuts();i[t.toString()].img=r,localStorage.setItem("shortcuts",JSON.stringify(i))}))}function did_a_day_pass(){let e=localStorage.getItem("date");if(localStorage.setItem("date",(new Date).getTime().toString()),null==e)return!0;let t=new Date(parseInt(e));return(new Date).getTime()-t.getTime()>864e5}function is_currency_rates_enabled(){let e=localStorage.getItem("is_currency_rates_enabled");return null==e||""==e||"false"==e?(hide_currency_elements(!0),!1):(hide_currency_elements(!1),!0)}function get_base_currency(){let e=localStorage.getItem("base_currency");return null==e&&(e="TRY",localStorage.setItem("base_currency",e)),e}function get_currencies(){let e=localStorage.getItem("currencies");if(null==e){let e=[{name:"USD",rate:"0.0"},{name:"EUR",rate:"0.0"},{name:"GBP",rate:"0.0"}];return localStorage.setItem("currencies",JSON.stringify(e)),e}return JSON.parse(e)}function get_updated_rates(){if(0==navigator.onLine)return void console.log("No internet connection. Cant get currency rates.");const e=get_base_currency().toLocaleLowerCase(),t=get_currencies(),n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){const n=JSON.parse(this.responseText);for(let a=0;a<3;a++){let r=t[a];const i=(1/parseFloat(n[e][r.name.toLocaleLowerCase()])).toFixed(2),s=parseFloat(i);update_color(node.currency.value+a,s-parseFloat(r.rate)),r.rate=i}localStorage.setItem("currencies",JSON.stringify(t)),update_currency_html_elements()}},n.open("GET",currency_api.concat(e,".min.json")),n.send()}function update_currency_html_elements(){const e=get_currencies();for(let t=0;t<3;t++){const n=e[t];document.getElementById(node.currency.name+t).innerHTML=n.name,document.getElementById(node.currency.value+t).innerHTML=n.rate}}function hide_currency_elements(e=!0){const t=document.getElementById("currencies"),n=Object.values(t.childNodes);for(const t of n)t.hidden=e}function update_color(e,t){const n=document.getElementById(e).parentElement;if(null==n)return;let a="bg-danger";t>=0&&(a="bg-success"),n.classList.replace("bg-primary",a)}function save(){const e=document.getElementsByClassName("navbar")[0];e.classList.replace("bg-transparent","bg-black")||e.classList.replace("bg-black","bg-transparent");let t=document.getElementById("base_currency").value;localStorage.setItem("base_currency",t);let n=document.getElementById("enable_api");localStorage.setItem("is_currency_rates_enabled",""+n.checked);let a=get_currencies(),r=get_shortcuts();for(let e=0;e<8;e++){if(e<3){const t=document.getElementById(node.currency.option+e);a[e].name=t.value}var i=r[e];const t=document.getElementById(node.shortcut_setting.link+e),n=document.getElementById(node.shortcut_setting.name+e),c=document.getElementById(node.shortcut_setting.img+e);if(i.link!=t.value){if(i.link=t.value.trim(),i.name!=n.value?i.name=n.value.trim():i.name="",""==c.value){i.img="",save_shortcuts(r);continue}}else if(i.name=n.value,""==c.value){save_shortcuts(r);continue}const l=new FileReader;l.addEventListener("loadend",(e=>{null!=e.target&&(i.img=e.target.result,save_shortcuts(r))}));var s=c.files;if(null!=s){var o=s.item(0);null!=o&&l.readAsDataURL(o)}}localStorage.setItem("currencies",JSON.stringify(a)),n.checked?(hide_currency_elements(!1),get_updated_rates()):hide_currency_elements(!0)}let check=0;function save_shortcuts(e){8==++check&&(check=0,localStorage.setItem("shortcuts",JSON.stringify(e)),configure_shortcuts(),config_settings_page())}function config_settings_page(){document.getElementById("enable_api").checked=is_currency_rates_enabled();document.getElementById("base_currency").value=get_base_currency();const e=get_shortcuts(),t=get_currencies();for(let s=0;s<8;s++){var n=e[s],a=document.getElementById(node.shortcut_setting.link+s),r=document.getElementById(node.shortcut_setting.name+s),i=document.getElementById(node.shortcut_setting.img+s);if(r.value=n.name,a.value=n.link,i.value="",!(s<3))continue;document.getElementById(node.currency.option+s).value=t[s].name}document.getElementById("save-button").addEventListener("click",save)}function translate(){let e;switch(navigator.language.toLowerCase().split("-")[0]){case"tr":e="tr";break;case"de":e="de";break;case"es":e="es";break;default:e="en"}[{name:"settings",tr:"Ayarlar",en:"Settings",de:"Einstellungen",es:"Ajustes"},{name:"delete-link",tr:"Bir linkin linkini silerek ana menüden kaldırabilirsin.",en:"Delete shortcut link to remove it from the main menu.",de:"Entfernen Sie die URL, um sie aus dem Hauptmenü zu löschen.",es:"Elimina el URL para quitarlo del menú principal."},{name:"image-link",tr:"Link ikonunu resim dosyası yükleyerek ayarlayabilirsin. (en az 64x64 boyutunda)",en:"Set a custom link icon by uploading an image file. (at least 64x64 resolution)",de:"Legen Sie ein benutzerdefiniertes Verknüpfungssymbol fest, indem Sie eine Bilddatei hochladen. (mindestens 64x64 Auflösung)",es:"Establece un ícono de enlace personalizado subiendo un archivo de imagen. (al menos 64x64 de resolución)"},{name:"delete-cookie-warning",tr:"Bu site için çerezleri silersen ayarların sıfırlanır.",en:"If you delete cookies for this site, all data will revert to the default values.",de:"Wenn Sie die Cookies für diese Website löschen, werden alle Daten auf die Standardwerte zurückgesetzt.",es:"Si eliminas las cookies de este sitio, todos los datos volverán a los valores predeterminados."},{name:"cookie-info",tr:"Bu site ayarları kaydetmek için çerez kullanır.",en:"This site uses cookies to save settings.",de:"Diese Website verwendet Cookies, um Einstellungen zu speichern.",es:"Este sitio utiliza cookies para guardar la configuración."},{name:"rate-update-info",tr:"Döviz değerleri günlük yenilenir.",en:"Currency rates update daily.",de:"Währungskurse werden täglich aktualisiert.",es:"Los tipos de cambio de divisas se actualizan diariamente."},{name:"enable-api-label",tr:"Kur bilgilerini göster",en:"Enable currency rates",de:"Währungskurse aktivieren",es:"Habilitar tasas de cambio de divisas"},{name:"currency-api-info",tr:"Döviz değerleri bu API kullanılarak alınmaktadır: https://github.com/fawazahmed0/currency-api",en:"Currency rates are provided by this API: https://github.com/fawazahmed0/currency-api",de:"Währungskurse werden von dieser API bereitgestellt: https://github.com/fawazahmed0/currency-api",es:"Las tasas de cambio de divisas son proporcionadas por esta API: https://github.com/fawazahmed0/currency-api"},{name:"currency-api-refresh-warning",tr:"Eğer seçtiğiniz kur güncellenmezse bir kaç saniye beklemeyi deneyin.",en:"If currency types do not update, try waiting a few seconds.",de:"Wenn sich die Währungskurse nicht aktualisieren, versuchen Sie es nach einigen Sekunden erneut.",es:"Si las tasas de cambio de divisas no se actualizan, intente esperar unos segundos."},{name:"api-key-info",tr:"Ana sayfanda 3 tane kurun değerini görmek istiyorsan kullanabilirsin.",en:"This is an optional feature that adds 3 currency rate info to your main page.",de:"Dies ist eine optionale Funktion, die 3 Währungskursinformationen auf Ihrer Hauptseite hinzufügt.",es:"Esta es una característica opcional que agrega información de 3 tasas de cambio de divisas a tu página principal."},{name:"save-button",tr:"Kaydet",en:"Save",de:"Speichern",es:"Guardar"},{name:"base-currency-label",tr:"Ana para birimini seç",en:"Select base currency",de:"Wählen Sie die Basiswährung",es:"Selecciona la moneda base"},{name:"currencies-label",tr:"Para birimleri",en:"Currencies",de:"Währungen",es:"Monedas"},{name:"link-label",tr:"Link",en:"Link",de:"URL",es:"URL"},{name:"name-label",tr:"İsim",en:"Name",de:"Name",es:"Nombre"},{name:"note-input",tr:"Kısa bir not giriniz",en:"Please enter a brief note",de:"Geben Sie eine kurze Notiz ein",es:"Ingresa una nota breve"},{name:"github-repo-info",tr:"Herhangi bir hata ile karşılaşırsanız veya yeni bir özellik isterseniz, buradan yeni bir issue açabilirsiniz: https://github.com/enfyna/fx-new-tab/issues",en:"If you encounter any issues or have a feature request, you can open a new issue at: https://github.com/enfyna/fx-new-tab/issues",de:"Wenn Sie auf einen Fehler gestoßen sind oder ein neues Feature wünschen, können Sie hier eine neue Issue öffnen: https://github.com/enfyna/fx-new-tab/issues",es:"Si has encontrado algún error o deseas una nueva función, puedes abrir un issue aquí: https://github.com/enfyna/fx-new-tab/issues"}].forEach((t=>{document.getElementsByName(t.name).forEach((n=>{const a=t[e];"note-input"==t.name&&(n.placeholder=a),n.innerHTML=a}))}))}